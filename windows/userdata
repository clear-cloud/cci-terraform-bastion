<powershell>
$ErrorActionPreference = "Stop"
#
# Install custom additional set-up PRE
#
${supplementary_user_data_pre}
#
#
#
#Disable windows firewall on all profiles
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False -ErrorAction Stop

# Change username
Rename-LocalUser -Name "Administrator" -NewName ${userName}

# Change admin password
$adminPassword = Get-SSMParameter -Name ${ComputerName} -WithDecryption $TRUE
$Admin = [adsi]("WinNT://$env:ComputerName/Graphite.Rack, user")
$Admin.Invoke("SetPassword", $adminPassword.value)


#
# Install custom additional set-up POST
#
${supplementary_user_data}
Restart-Computer
</powershell>
